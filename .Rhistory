library(broom)
library(purrr)
library(ggthemes)
library(countrycode)
library(tmap)
data("World")
load("worldbankindicators.RData")
load("~/Google Drive/My Drive/BHT_Data_Science/visualization/inflation2/inflation/worldbankindicators.RData")
# load the required libraries and datasets
knitr::opts_chunk$set(echo = TRUE, message= FALSE, warning= FALSE)
library(reticulate)
library("sf")
library("rnaturalearth")
library("rnaturalearthdata")
library(tidyverse)
library(countrycode)
library(plotly)
library(broom)
library(purrr)
library(ggthemes)
library(countrycode)
library(tmap)
data("World")
load("worldbankindicators.RData")
View(worldbank_data)
setwd("~/Library/CloudStorage/GoogleDrive-liu.leonhard@gmail.com/My Drive/BHT_Data_Science/visualization/inflation2/inflation")
# load the required libraries and datasets
knitr::opts_chunk$set(echo = TRUE, message= FALSE, warning= FALSE)
library(reticulate)
library("sf")
library("rnaturalearth")
library("rnaturalearthdata")
library(tidyverse)
library(countrycode)
library(plotly)
library(broom)
library(purrr)
library(ggthemes)
library(countrycode)
library(tmap)
data("World")
load("worldbankindicators.RData")
### manipulation of the datasets for further usage
# change country code in the World dataset with countrycode()
World$iso2c=countrycode(sourcevar = World$iso_a3,
origin = "iso3c",
destination = "iso2c")
# average of the indicators (inflation, GDP, Interest rate, Population, Unemployment) from the worldbank dataset
averaged_data <- worldbank_data%>%
group_by(iso2c, country, Indicator)%>%
summarise(Values=mean(Values,na.rm=T))
# filter by the most recent year, named here as 'current_data'
current_data <- worldbank_data %>%
filter(year==2000)
# join 'World' dataset with worldbank dataset
joined_data <- World%>%left_join(current_data, by='iso2c')
# filter only for inflation and unemployment
inflation <- filter(joined_data, Indicator=='Inflation')
unemployment <- filter(joined_data, Indicator =='Unemployment')
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = (gdp_cap_est),
y = (life_exp),
size= pop_est,
)) +
geom_point(alpha=0.1) +
xlim(0,90000) +
geom_smooth(se=F)+
#facet_wrap(~continent)+
labs(title='life expectancy compared to GDP per capita for all countries',
x = 'GDP per capita',
y = 'Life expectancy',
colour = 'continent')
# life expectancy vs GDP per capita for each continent
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = (gdp_cap_est),
y = (life_exp),
size= pop_est,
color=continent
)) +
geom_point(alpha = 0.1)+
xlim(0,65000) +
geom_smooth(method=lm, se=F)+
facet_wrap(~continent)+
labs(title='Life expectancy and GDP per capita for various continents',
x = 'GDP per capita',
y = 'Life expectancy',
colour = 'continent')
# HPI and GDP per capita for all countries
joined_data %>%
ggplot(aes(x = log(gdp_cap_est),
y = HPI,
size= pop_est,
)) +
geom_point(alpha = 0.1)+
geom_smooth(method=lm, se=T)+
labs(title='HPI and GDP per capita',
x = 'GDP per capita',
y = 'HPI',
colour = 'continent')
# HPI and GDP per capita for each continent
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = log(gdp_cap_est),
y = HPI,
size= pop_est,
color=continent
)) +
geom_point(alpha = 0.1)+
geom_smooth(method=lm, se=T)+
facet_wrap(~continent)+
labs(title='HPI and GDP per capita',
x = 'GDP per capita',
y = 'HPI',
colour = 'continent')
# Life Expectancy And HPI
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = life_exp,
y = HPI,
size= pop_est,
color=pop_est_dens
)) +
geom_point(alpha = 0.1)+
geom_smooth(method=lm, se=F)+
labs(title='HPI and Life Expectancy',
x = 'Life Expectancy',
y = 'HPI')
# HPI vs Inequality for all countries
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = inequality,
y = HPI,
size= pop_est,
color=pop_est_dens
)) +
geom_point(alpha = 0.1)+
geom_smooth(method=lm, se=F)+
labs(title='HPI and Inequality',
x = 'Inequality',
y = 'HPI')
# plotting inflation of year 2020
ggplot(data = inflation) +
geom_sf(aes(fill=Values)) +
colorspace::scale_fill_continuous_sequential(palette='viridis') +
labs(caption= 'Inflation Map 2020')
# reshape long to wide for comparison between different indicators
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
filtered %>%
mutate(Indicator = as.factor(Indicator))
wide_data <- filtered %>%
pivot_wider(names_from = Indicator, values_from = Values)
# inflation vs interest rate
wide_data %>%
ggplot(aes(y = log(Inflation),
x = `Interest Rate`,
size= GDP,
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
#facet_wrap(~continent)+
labs(title='Inflation and Interest rate',
x = 'log(Inflation)',
y = 'Interest Rate')
# inflation vs unemployment?
ger_usa <- worldbank_data %>%
filter(country == 'Germany' | country == 'United States' )
ger_usa_wide <- ger_usa %>%
pivot_wider(names_from = Indicator, values_from = Values)
ger_usa_wide %>%
ggplot(aes(x = (Unemployment),
y = (Inflation),
color= country,
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
#facet_wrap(~continent)+
labs(title='Inflation and unemployment for US and Germany 2000-2020',
x = 'Unemployment rate',
y = 'Inflation')
# inflation vs interest rate
wide_data %>%
ggplot(aes(y = log(Inflation),
x = unemployment,
size= GDP,
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~continent)+
labs(title='Inflation and Interest rate',
x = 'log(Inflation)',
y = 'Interest Rate')
# reshape long to wide for comparison between different indicators
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
filtered %>%
mutate(Indicator = as.factor(Indicator))
wide_data <- filtered %>%
pivot_wider(names_from = Indicator, values_from = Values)
# inflation vs interest rate
wide_data %>%
ggplot(aes(y = log(Inflation),
x = `Interest Rate`,
size= GDP,
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
#facet_wrap(~continent)+
labs(title='Inflation and Interest rate',
x = 'log(Inflation)',
y = 'Interest Rate')
# inflation vs unemployment?
ger_usa <- worldbank_data %>%
filter(country == 'Germany' | country == 'United States' )
ger_usa_wide <- ger_usa %>%
pivot_wider(names_from = Indicator, values_from = Values)
ger_usa_wide %>%
ggplot(aes(x = (Unemployment),
y = (Inflation),
color= country,
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
#facet_wrap(~continent)+
labs(title='Inflation and unemployment for US and Germany 2000-2020',
x = 'Unemployment rate',
y = 'Inflation')
# inflation vs interest rate
wide_data %>%
ggplot(aes(y = log(Inflation),
x = unemployment,
size= GDP
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~continent)+
labs(title='Inflation and Interest rate',
x = 'log(Inflation)',
y = 'Interest Rate')
# inflation vs interest rate
wide_data %>%
ggplot(aes(y = log(Inflation),
x = unemployment,
size= GDP
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~continent)+
labs(title='Inflation and Interest rate',
x = 'log(Inflation)',
y = 'Interest Rate')
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
filtered %>%
mutate(Indicator = as.factor(Indicator))
wide_data <- filtered %>%
pivot_wider(names_from = Indicator, values_from = Values)
# inflation vs interest rate
wide_data %>%
ggplot(aes(y = log(Inflation),
x = unemployment,
size= GDP
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~continent)+
labs(title='Inflation and Interest rate',
x = 'log(Inflation)',
y = 'Interest Rate')
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
filtered %>%
mutate(Indicator = as.factor(Indicator))
wide_data <- filtered %>%
pivot_wider(names_from = Indicator, values_from = Values)
# inflation vs interest rate
wide_data %>%
ggplot(aes(y = log(Inflation),
x = unemployment,
size= GDP,
color = income_grp
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~income_grp)+
labs(title='Inflation and Interest rate',
x = 'log(Inflation)',
y = 'Interest Rate')
# inflation and unemployment
wide_data %>%
ggplot(aes(y = log(Inflation),
x = Unemployment,
color= income_grp,)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~income_grp)+
labs(title='Inflation and Interest rate',
x = 'unemployment',
y = 'log(inflation)')
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
filtered %>%
mutate(Indicator = as.factor(Indicator))
wide_data <- filtered %>%
pivot_wider(names_from = Indicator, values_from = Values)
# inflation vs interest rate
# inflation and unemployment
wide_data %>%
ggplot(aes(y = log(Inflation),
x = Unemployment,
color= income_grp,)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~income_grp)+
labs(title='Inflation and Interest rate',
x = 'unemployment',
y = 'log(inflation)')
# load the required libraries and datasets
knitr::opts_chunk$set(echo = TRUE, message= FALSE, warning= FALSE)
library(reticulate)
library("sf")
library("rnaturalearth")
library("rnaturalearthdata")
library(tidyverse)
library(countrycode)
library(plotly)
library(broom)
library(purrr)
library(ggthemes)
library(countrycode)
library(tmap)
data("World")
load("worldbankindicators.RData")
### manipulation of the datasets for further usage
# change country code in the World dataset with countrycode()
World$iso2c=countrycode(sourcevar = World$iso_a3,
origin = "iso3c",
destination = "iso2c")
# average of the indicators (inflation, GDP, Interest rate, Population, Unemployment) from the worldbank dataset
averaged_data <- worldbank_data%>%
group_by(iso2c, country, Indicator)%>%
summarise(Values=mean(Values,na.rm=T))
# filter by the most recent year, named here as 'current_data'
current_data <- worldbank_data %>%
filter(year==2000)
# join 'World' dataset with worldbank dataset
joined_data <- World%>%left_join(current_data, by='iso2c')
# filter only for inflation and unemployment
inflation <- filter(joined_data, Indicator=='Inflation')
unemployment <- filter(joined_data, Indicator =='Unemployment')
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = (gdp_cap_est),
y = (life_exp),
size= pop_est,
)) +
geom_point(alpha=0.1) +
xlim(0,90000) +
geom_smooth(se=F)+
#facet_wrap(~continent)+
labs(title='life expectancy compared to GDP per capita for all countries',
x = 'GDP per capita',
y = 'Life expectancy',
colour = 'continent')
# life expectancy vs GDP per capita for each continent
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = (gdp_cap_est),
y = (life_exp),
size= pop_est,
color=continent
)) +
geom_point(alpha = 0.1)+
xlim(0,65000) +
geom_smooth(method=lm, se=F)+
facet_wrap(~continent)+
labs(title='Life expectancy and GDP per capita for various continents',
x = 'GDP per capita',
y = 'Life expectancy',
colour = 'continent')
# HPI and GDP per capita for all countries
joined_data %>%
ggplot(aes(x = log(gdp_cap_est),
y = HPI,
size= pop_est,
)) +
geom_point(alpha = 0.1)+
geom_smooth(method=lm, se=T)+
labs(title='HPI and GDP per capita',
x = 'GDP per capita',
y = 'HPI',
colour = 'continent')
# HPI and GDP per capita for each continent
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = log(gdp_cap_est),
y = HPI,
size= pop_est,
color=continent
)) +
geom_point(alpha = 0.1)+
geom_smooth(method=lm, se=T)+
facet_wrap(~continent)+
labs(title='HPI and GDP per capita',
x = 'GDP per capita',
y = 'HPI',
colour = 'continent')
# Life Expectancy And HPI
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = life_exp,
y = HPI,
size= pop_est,
color=pop_est_dens
)) +
geom_point(alpha = 0.1)+
geom_smooth(method=lm, se=F)+
labs(title='HPI and Life Expectancy',
x = 'Life Expectancy',
y = 'HPI')
# HPI vs Inequality for all countries
joined_data %>%
filter(continent %in% c('Asia', 'Africa', 'Europe', 'South America', 'Oceania', 'North America')) %>%
ggplot(aes(x = inequality,
y = HPI,
size= pop_est,
color=pop_est_dens
)) +
geom_point(alpha = 0.1)+
geom_smooth(method=lm, se=F)+
labs(title='HPI and Inequality',
x = 'Inequality',
y = 'HPI')
# plotting inflation of year 2020
ggplot(data = inflation) +
geom_sf(aes(fill=Values)) +
colorspace::scale_fill_continuous_sequential(palette='viridis') +
labs(caption= 'Inflation Map 2020')
# reshape long to wide for comparison between different indicators
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
filtered %>%
mutate(Indicator = as.factor(Indicator))
wide_data <- filtered %>%
pivot_wider(names_from = Indicator, values_from = Values)
# inflation vs interest rate
wide_data %>%
ggplot(aes(y = log(Inflation),
x = `Interest Rate`,
size= GDP,
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
#facet_wrap(~continent)+
labs(title='Inflation and Interest rate',
x = 'log(Inflation)',
y = 'Interest Rate')
# inflation vs unemployment?
ger_usa <- worldbank_data %>%
filter(country == 'Germany' | country == 'United States' )
ger_usa_wide <- ger_usa %>%
pivot_wider(names_from = Indicator, values_from = Values)
ger_usa_wide %>%
ggplot(aes(x = (Unemployment),
y = (Inflation),
color= country,
)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
#facet_wrap(~continent)+
labs(title='Inflation and unemployment for US and Germany 2000-2020',
x = 'Unemployment rate',
y = 'Inflation')
# inflation and unemployment
wide_data %>%
ggplot(aes(y = log(Inflation),
x = Unemployment,
color= income_grp,)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~income_grp)+
labs(title='Inflation and Interest rate',
x = 'unemployment',
y = 'log(inflation)')
# inflation and unemployment
wide_data %>%
ggplot(aes(y = log(Inflation),
x = Unemployment,
color= income_grp,)) +
geom_point(alpha=0.3)+
geom_smooth(method=lm, se=F)+
facet_wrap(~income_grp)+
labs(title='Inflation and Interest rate',
x = 'unemployment',
y = 'log(inflation)')
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
columns <- c('iso_a3', 'country', 'Indicator', 'Values', 'continent', 'economy', 'income_grp')
filtered <- joined_data[columns] %>%
st_drop_geometry()
